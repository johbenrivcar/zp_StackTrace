# zp_StackTrace

This is an Excel vba stack tracer for helping with debugging Excel apps

You use this code to generate an indented record of function calls through executing code in real time, on-screen or sent to a text file for later analysis.

The code is available either as an add-in or as an .xslm file.

Simple example:

```
Public ZP As New zp_clsCore

Sub Main()
'// Mark the entry to sub Main
Dim T: Set T = ZP.enter("Main")
    '// Write log file to folder /logs
    ZP.sendLogToFile
    '// Start writing to the log
    ZP.startLog
    '// Write a message to the log
    ZP.msg ("Calling ABC")
    '// Call the sub ABC
    ABC
    '// Write a message to the log after calling ABC
    ZP.msg ("After calling ABC")
End Sub

Sub ABC()
'// Mark the entry to sub ABC
Dim T: Set T = ZP.enter("ABC")
    '// -- Code for sub ABC goes here
    '// Write a message to the log
    ZP.msg ("This message is written to the log indented with the call stack")
    DEF
    '// -- Other code
End Sub

Sub DEF()
'// Mark entry to DEF
Dim T: Set T = ZP.enter("DEF")
    '// Message to log within DEF
    ZP.msg ("Write to log within DEF")
  
End Sub
```

The ouput generated by the above code, written to the log file is:

```
LVL 05/04/2023 18:06:26
 1    0||>| Enter Main
 1    0| .| Calling ABC
 2    0| .|>| Enter ABC
 2    0| . .| This message is written to the log indented with the call stack
 3    0| . .|>| Enter DEF
 3    0| . . .| Write to log within DEF
 3    0| . .|<| Exit DEF
 2    0| .|<| Exit ABC
 1    0| .| After calling ABC
 1    0||<| Exit Main
    05/04/2023 18:06:26
```

The log shows the following information:

* The first line is a time stamp when the log file is opened
* Each subsequent line shows:
* * cols 1-2: The level within the call stack. The first call to ZP.enter moves from level 0 to level
* * cols 4-8: Milliseconds since the previous change from level 0 to level 1
* * cols 10-x: A number of period "." marks separated by spaces. Each period represents one level in the call stack



